{"filter":false,"title":"TCPChatClient.c","tooltip":"/lp3-primer-final/TCPChatClient.c","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":98,"column":1},"action":"insert","lines":["/* "," * NO ES MULTI HILOOOO :'C"," * CUANDO COMENZE LA DOCUMENTACION ME DI CUENTA :'(","*/","#include <sys/socket.h>","#include <sys/types.h>","#include <netinet/in.h>","#include <netdb.h>","#include <stdio.h>","#include <time.h>","#include <string.h>","#include <unistd.h>","#include <errno.h>","#include <stdlib.h>","#include \"PTI_functions/socketClient.h\"","","#define LINELEN 1024","","","int main(int argc, char *argv[]){","\tint intervalo  = 5; //intervalo de cada n segundos enviar datos al servidor ","\tchar *host = \"localhost\";\t/* host to use if none supplied\t*/","\tchar *service = \"15000\";\t/* default service name\t\t*/","\ttime_t\tnow;\t\t\t/* 32-bit integer to hold time\t*/","\tint s, n;\t\t\t/* socket descriptor, read count*/","\tchar retorno[LINELEN];//definicion de la variable retorno en donde se almacenara la respuesta del servidor","\tchar mensaje[LINELEN];//variable mensaje que almancena el mensaje a enviar, en nuestro caso utilizaremos propias variables","\t","\tchar *p;","\t","\t//aqui inicializamos las variables posibles ","\tchar mensaje1[] = \"enviado 200 - OK\";","\tchar mensaje2[] = \"recibido 200 - OK\";","\t","\tchar mensaje3[] = \"enviado 400 - Bad Request\";","\tchar mensaje4[] = \"recibido 400 - Registered\";","\t","\tchar mensaje5[] = \"500 - Internal Error.\";","\tchar mensaje6[] = \"CualquierCosa :D\";","\t","\t","\tswitch (argc) {//analizamos si se dieron argumentos para iniciar el cliente","\tcase 1:","\t\thost = \"localhost\";","\t\tbreak;","\tcase 3:","\t\tservice = argv[2];","\tcase 2:","\t\thost = argv[1];","\t\tbreak;","\tdefault:","\t\tfprintf(stderr, \"uso: TCPTimeClient [host [puerto]]\\n\");","\t\texit(1);","\t}","\tint numero = 0;","\ts = connectTCP(host, service);//iniciamos el socket conectandonos a la ip host y el puerto service ","\twhile(1){","\t\t","\t\t//imprime fecha y hora","\t\t\t","\t\ttime_t tiempo = time(0);","\t\tstruct tm *tlocal = localtime(&tiempo);","\t\tchar output[128];","\t\tstrftime(output,128,\"%d/%m/%y %H:%M:%S\",tlocal);","\t\tprintf(\"Se envia y recibe datos el: %s\\n\",output);","\t\t\t","\t\t// aqui sorteamos que enviarle al servidor, mensaje ok, mensaje error o cualquier cosa","\t\tnumero = rand () % 3 ;","\t\t","\t\tif(numero == 0){","\t\t\tprintf(\"El cliente envia: %s\\n\", mensaje1);","\t\t\t(void) write(s, mensaje1, LINELEN);//en la variable mensaje se encuentra el mensaje a enviar","\t\t\t  ","\t\t}","\t\tif(numero == 1){","\t\t\tprintf(\"El cliente envia: %s\\n\", mensaje3);","\t\t\t(void) write(s, mensaje3, LINELEN);//en la variable mensaje se encuentra el mensaje a enviar","\t\t\t","\t\t}","\t\tif(numero == 2){","\t\t\tprintf(\"El cliente envia: %s\\n\", mensaje6);","\t\t\t(void) write(s, mensaje6, LINELEN);//en la variable mensaje se encuentra el mensaje a enviar","\t\t}","\t\t","","\t\t// Leer la respuesta del servidor ","\t\tn = read(s, (char *)&retorno, sizeof(retorno));","\t\tif (n < 0){","\t\t        printf(\"Fallo del read \\\"%s\\\" \\n\", strerror(errno));","\t\t        exit(1);","\t\t}","\t\tprintf(\"El Cliente recibe: %s \\nDurmiendo %d segundos...\\n\\n\\n\", retorno, intervalo);","\t\t","\t\tsleep(intervalo);//hacemos dormir el proceso por intervalo segundos","\t\t","\t}","\t","\texit(0);","}"],"id":1}]]},"ace":{"folds":[],"scrolltop":608.5,"scrollleft":0,"selection":{"start":{"row":67,"column":24},"end":{"row":67,"column":24},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":49,"state":"start","mode":"ace/mode/c_cpp"}},"timestamp":1466641358928,"hash":"f4d99c425306dfbf68e39f99e82583aaae21ccaf"}